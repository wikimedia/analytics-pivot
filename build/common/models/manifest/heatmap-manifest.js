"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var split_combine_1=require("../split-combine/split-combine");var splits_1=require("../splits/splits");var base_manifest_1=require("./base-manifest");var HeatmapManifest=function(e){tslib_1.__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.name="heatmap";t.title="Heatmap";return t}t.prototype.canHandleSplitDimensions=function(e,t,i,n){if(t.length===2)return base_manifest_1.Resolve.proceedWithDimensions();var s=e.slice(0,2);var r=function(e){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(e,i,n)};if(s.length!==2){return base_manifest_1.Resolve.rejectDimensions("Not enough dimensions in this data cube for a Heatmap",[])}if(!t.length){return base_manifest_1.Resolve.rejectDimensions("The Heatmap requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("splitting on "+s.map(function(e){return e.title}).join(", "),new splits_1.Splits(s.map(r)))])}else if(t.length===1){var a=t[0];var l=e.find(function(e){return!e.equals(a)});if(!l)throw new Error;return base_manifest_1.Resolve.rejectDimensions("The Heatmap requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("adding a split on "+l.title,new splits_1.Splits([r(a),r(l)]))])}else{return base_manifest_1.Resolve.rejectDimensions("Too many splits on the Heatmap",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("removing all but the first two splits",new splits_1.Splits(s.map(r)))])}};t.prototype.getEffectiveSplits=function(e){var t=false;var i=new splits_1.Splits(e.splitCombines.map(function(e){if(!e.limitAction){t=true;return e.changeLimit(25)}return e}));return t?i:e};t.prototype.getSuitability=function(e,t,i,n){var s=t.splitCombines.filter(function(t){return t.getDimension(e).isContinuous()}).length;return new base_manifest_1.Suitability(3+(s>1?6:0))};return t}(base_manifest_1.Manifest);exports.HeatmapManifest=HeatmapManifest;exports.HEATMAP_MANIFEST=new HeatmapManifest;