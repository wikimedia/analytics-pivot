"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var immutable_class_1=require("immutable-class");var data_cube_1=require("../data-cube/data-cube");var essence_1=require("../essence/essence");var CollectionTile=function(e){tslib_1.__extends(t,e);function t(t){var i=e.call(this,t)||this;i.title=i.title||beltful_1.StringUtils.makeTitle(name);return i}t.isCollectionTile=function(e){return e instanceof t};t.fromEssence=function(e,i){return new t({name:e,title:i.getTitle(),description:"",essence:i,group:null,dataCube:i.dataCube})};t.fromJS=function(e,i){if(!i)throw new Error("CollectionTile must have context");var a=i.dataCubes,l=i.visualizations;var n=e.dataCube;var s=immutable_class_1.SimpleArray.find(a,function(e){return e.name===n});if(!s)throw new Error("can not find dataCube '"+n+"'");var u=essence_1.Essence.fromJS(e.essence,{dataCube:s,visualizations:l});return new t({name:e.name,title:e.title,description:e.description,position:e.position?beltful_1.Stage.fromJS(e.position):null,group:e.group,dataCube:s,essence:u})};t.prototype.equals=function(e){return t.isCollectionTile(e)&&this.name===e.name&&this.title===e.title&&this.description===e.description&&immutable_class_1.immutableEqual(this.position,e.position)&&this.group===e.group&&this.dataCube.name===e.dataCube.name&&immutable_class_1.immutableEqual(this.essence,e.essence)};t.prototype.getEffectiveEssence=function(e){var t=this.essence;if(!e)return t;return t.addToFilter(e.filter).changeHighlight(e.highlight)};return t}(immutable_class_1.BaseImmutable);CollectionTile.PROPERTIES=[{name:"name",validate:beltful_1.StringUtils.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"description",defaultValue:null},{name:"position",immutableClass:beltful_1.Stage,defaultValue:null},{name:"group",defaultValue:null},{name:"dataCube",immutableClass:data_cube_1.DataCube,toJS:function(e){return e.name}},{name:"essence",immutableClass:essence_1.Essence}];exports.CollectionTile=CollectionTile;immutable_class_1.BaseImmutable.finalize(CollectionTile);