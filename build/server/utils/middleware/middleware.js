"use strict";Object.defineProperty(exports,"__esModule",{value:true});var models_1=require("../../../common/models");var strings_1=require("../../../common/utils/constants/strings");var config_1=require("../../config");var views_1=require("../../views");function authenticatedOnly(e,t,n){if(e.session["loggedIn"]){if(!e.user)e["user"]=models_1.User.fromJS(e.session["user"]);n()}else{t.send(views_1.loginLayout({version:config_1.VERSION,title:strings_1.STRINGS.loginToPivot}))}}exports.authenticatedOnly=authenticatedOnly;function unauthenticatedOnly(e,t,n){if(e.session["loggedIn"]){t.redirect("/")}else{n()}}exports.unauthenticatedOnly=unauthenticatedOnly;function authorizationCheck(e){return function(t,n,s){var i=t.user.resources;if(!i)return s();if(i.indexOf("*")===-1&&i.indexOf(e)===-1){throw{status:404,message:"Not Found"}}else{s()}}}exports.authorizationCheck=authorizationCheck;exports.logout=function(e,t,n){e.session["loggedIn"]=false;t.redirect("/")};