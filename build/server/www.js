"use strict";Object.defineProperty(exports,"__esModule",{value:true});var debugModule=require("debug");var http=require("http");var config_1=require("./config");var wrapperServer=require("./wrapper-app");process.on("uncaughtException",function(e){console.error("!!! There was an unhandled exception: !!!");console.error(e);console.error("!!! !!! !!! !!! !!! !!! !!! !!! !!!")});if(config_1.START_SERVER){var debug_1=debugModule("pivot:www");var httpServer_1=http.createServer(wrapperServer.getApp());httpServer_1.on("error",function(e){if(e.syscall!=="listen"){throw e}switch(e.code){case"EACCES":console.error("Port "+config_1.SERVER_SETTINGS.getPort()+" requires elevated privileges");process.exit(1);break;case"EADDRINUSE":console.error("Port "+config_1.SERVER_SETTINGS.getPort()+" is already in use");process.exit(1);break;default:throw e}});httpServer_1.on("listening",function(){var e=httpServer_1.address();console.log("Pivot is listening on address "+e.address+" port "+e.port);debug_1("Pivot is listening on address "+e.address+" port "+e.port)});wrapperServer.getApp().set("port",config_1.SERVER_SETTINGS.getPort());httpServer_1.listen(config_1.SERVER_SETTINGS.getPort(),config_1.SERVER_SETTINGS.getServerHost())}